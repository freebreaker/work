(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{518:function(e,t,a){var n=a(519);"string"===typeof n&&(n=[[e.i,n,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};a(55)(n,i);n.locals&&(e.exports=n.locals)},519:function(e,t,a){(e.exports=a(50)(!1)).push([e.i,"",""])},542:function(e,t,a){"use strict";a.r(t);var n=a(165),i=a(27),l=a(28),o=a(31),r=a(29),s=a(164),d=a(30),u=a(0),c=a(472),m=a(94),p=a(476),h=a(121),f=a(37),g=a(471),b=a(475),y=a(470),v=a(465),C=a(9),E=a(82),I=a(95),k=(a(518),a(21)),S=function(e){function t(){return Object(i.a)(this,t),Object(o.a)(this,Object(r.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=[{title:"\u6a21\u5757\u540d",dataIndex:"name",key:"name"},{title:"\u6743\u9650\u660e\u7ec6",dataIndex:"details",key:"details",render:function(t,a){var n=t.allOptions.map(function(e,t){return{label:e.authName,value:e.id}}),i=t.options.map(function(e,t){return e.id});return u.createElement("span",null,u.createElement(E.a.Group,{options:n,defaultValue:i,onChange:function(t){return e.props.editData(a.key,t)}}))}}];return u.createElement("div",null,u.createElement(g.a,{columns:t,dataSource:this.props.tableData,locale:{filterConfirm:"\u786e\u5b9a",filterReset:"\u91cd\u7f6e",emptyText:"\u6682\u65e0\u6570\u636e"}}))}}]),t}(u.Component),w=a(39),O=a.n(w),D=a(126),j=a(466),x=function(e){function t(){return Object(i.a)(this,t),Object(o.a)(this,Object(r.a)(t).apply(this,arguments))}return Object(d.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=[{color:"#607d8b",content:"\u626c\u5dde"},{color:"#03a9f4",content:"\u868c\u57e0"}];return u.createElement("div",null,u.createElement(j.a,{color:e[this.props.type].color},e[this.props.type].content))}}]),t}(u.Component),V=c.a.Dragger,R=m.a.Option;var N=function(e){function t(){var e,a;Object(i.a)(this,t);for(var n=arguments.length,l=new Array(n),d=0;d<n;d++)l[d]=arguments[d];return(a=Object(o.a)(this,(e=Object(r.a)(t)).call.apply(e,[this].concat(l)))).state={files:[],updateId:1,selectedRowKeys:[],selectedPetKeys:[],selectedPetTypeKeys:[],loading:!1,filteredInfo:null,sortedInfo:"",visible:!1,editVisible:!1,addVisible:!1,value:2,imageSrc:"",imageUrl:"",defaultRoleName:"",defalutSizeValue:6,editSizeVisible:!1,tableData:[],resTableData:[],resRoleTableData:[],showImage:!1,roleChildrenTableData:[],roleGroupId:1,submitMenu:[],menus:[],menuName:"",menuUrl:"",menuAddMenuChildren:[],menusList:[],editGroupModal:!1,editGroupData:[],groupData:[],radioValue:"",adminId:1,name:"",pwd:"",realName:"",groupId:1,phone:"",email:"",cityCode:"321000"},a.onSelectChange=function(e){a.setState({selectedRowKeys:e})},a.handleChange=function(e,t,n){a.setState({filteredInfo:t,sortedInfo:n})},a.handleDelete=function(e){},a.addRole=function(){a.showDrawer()},a.addAdminUser=function(){var e=a.state,t=e.name,n=e.pwd,i=e.groupId;Object(k.a)({method:"post",url:"/adminusers/add",data:{name:t,pwd:n,groupId:i}}).then(function(e){e?(p.a.success("\u6dfb\u52a0\u6210\u529f"),setTimeout(function(){window.location.reload()},500)):p.a.error("\u5220\u9664\u5931\u8d25")})},a.addMenu=function(e){var t=Object(s.a)(a);Object(k.a)({method:"get",url:"/menu/list?roleGroupId=".concat(e.key)}).then(function(a){a&&t.setState({addVisible:!0,menus:a,roleGroupId:e.key})})},a.editRole=function(e){var t=Object(s.a)(a);Object(k.a)({method:"get",url:"/role/menus?id=".concat(e.key)}).then(function(a){if(a){var n=a.map(function(e,t){return{key:e.id,name:e.menuName,details:{options:e.menuChildren,allOptions:e.allMenuChildren},menuChildrenIds:e.menuIds}});t.setState({editVisible:!0,defaultRoleName:e.name,roleGroupId:e.key,roleChildrenTableData:n})}})},a.showDrawer=function(){var e=Object(s.a)(a);Object(k.a)({method:"get",url:"/role/list"}).then(function(t){t&&e.setState({groupData:t,visible:!0})})},a.deleteRole=function(){var e=a.state.selectedRowKeys;Object(k.a)({method:"post",url:"/user/delete",data:{ids:e}}).then(function(e){e?(p.a.success("\u5220\u9664\u6210\u529f"),setTimeout(function(){window.location.reload()},500)):p.a.error("\u5220\u9664\u5931\u8d25")})},a.editSubmitRole=function(e,t){var n=a.state.submitMenu,i=n.map(function(a){return a.id===e?{id:e,ids:t}:a});n.find(function(t){return t.id===e})?a.setState({submitMenu:i}):(i.push({id:e,ids:t}),a.setState({submitMenu:i}))},a.submitRole=function(){Object(k.a)({method:"post",url:"/role/edit",data:{editArr:a.state.submitMenu}}).then(function(e){e?(p.a.success("\u4fee\u6539\u6210\u529f"),setTimeout(function(){window.location.reload()},500)):p.a.error("\u4fee\u6539\u5931\u8d25")})},a.onMenuSelectChange=function(e,t){Object(k.a)({method:"get",url:"/menu/path?name=".concat(e)}).then(function(n){n&&a.setState({menusList:n,menuUrl:e,menuName:t.props.children})})},a.onCheckboxSelectChange=function(e){a.setState({menuAddMenuChildren:e})},a.sumitAddMenu=function(){var e=a.state,t=e.menuName,n=e.roleGroupId,i=e.menuUrl,l=e.menuAddMenuChildren;Object(k.a)({method:"post",url:"/menu/add",data:{roleGroupId:n,menuName:t,menuUrl:i,menuAddMenuChildren:l}}).then(function(e){e?(p.a.success("\u6dfb\u52a0\u6210\u529f"),setTimeout(function(){window.location.reload()},1e3)):p.a.error("\u6dfb\u52a0\u5931\u8d25")})},a.editGroup=function(e){var t=Object(s.a)(a);Object(k.a)({method:"get",url:"/role/list"}).then(function(a){a&&t.setState({editGroupModal:!0,editGroupData:a,adminId:e.key})})},a.handleOk=function(){var e=a.state,t=e.radioValue,n=e.adminId;Object(k.a)({method:"post",url:"/adminusers/group",data:{groupId:t,adminId:n}}).then(function(e){e?(p.a.success("\u4fee\u6539\u6210\u529f"),setTimeout(function(){window.location.reload()},500)):p.a.error("\u4fee\u6539\u5931\u8d25")})},a.handleCancel=function(){a.setState({editGroupModal:!1})},a.radioChange=function(e){a.setState({radioValue:e.target.value})},a.addRadioChange=function(e){a.setState({groupId:e.target.value})},a.handleSubmit=function(e){e.preventDefault();var t=a.state.imageUrl;a.props.form.validateFieldsAndScroll(function(e,a){var n=a.name,i=a.pwd,l=a.groupId,o=a.realName,r=a.email,s=a.phone,d=a.cityCode;e||Object(k.a)({method:"post",url:"/adminusers/add",data:{name:n,pwd:i,realName:o,groupId:l,email:r,phone:s,cityCode:d,icon:t}}).then(function(e){e?(p.a.success("\u6dfb\u52a0\u6210\u529f"),setTimeout(function(){window.location.reload()},500)):p.a.error("\u5220\u9664\u5931\u8d25")})})},a.handleUpload=function(e){var t=e.fileList,n=e.file,i=n.name,l=localStorage.getItem("adminId"),o=(new Date).getTime().toString();if(l)for(;l.length<36;)l+="x";else alert("\u8bf7\u91cd\u65b0\u767b\u9646");var r="".concat(l).concat(o,"ao12");t.map(function(e,t){e.name===i&&(e.name=r)});var s=localStorage.getItem("uploadToken");s&&Object(D.b)(n,r,s,"ao");var d=Object(D.a)(t);a.setState({files:t,imageUrl:d})},a}return Object(d.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;Object(k.a)({method:"get",url:"/adminusers/list"}).then(function(t){if(t.length>0){var a=t.map(function(e,t){return{key:e.id,name:e.name,nickname:e.nickname,image:e.icon?e.icon:"",usertype:e.groupId?e.groupId.roleName:"----",phone:e.tel,ip:e.ip?e.ip:"----",icon:e.icon,realName:e.realName,cityCode:e.cityCode,registertime:e.ct?O()(parseInt(e.ct,10)).format("YYYY-MM-DD H:mm:ss"):"----",lastlogintime:e.lastLoginTime?O()(parseInt(e.lastLoginTime,10)).format("YYYY-MM-DD H:mm:ss"):"----"}});e.setState({tableData:a,resTableData:t,resRoleTableData:t})}})}},{key:"render",value:function(){var e=this,t=this,a=this.state,i=a.selectedRowKeys,l=a.tableData,o=a.roleChildrenTableData,r=a.roleGroupId,s=a.menus,d=a.menusList,c=this.state.filteredInfo;c=c||{};var p,k,w=[{title:"\u7528\u6237\u540d",dataIndex:"name",key:"name"},{title:"\u56fe\u7247",dataIndex:"image",key:"image",render:function(e,a){return""!==a.image?a.image.split(",").map(function(e,a){return u.createElement("a",{href:"javascript:void(0);",key:a,onClick:function(){t.setState({imageSrc:e,showImage:!0})}},"\u70b9\u51fb\u67e5\u770b")}):u.createElement("span",null,"\u6682\u65e0")}},{title:"\u89d2\u8272\u7c7b\u578b",dataIndex:"usertype",key:"usertype"},{title:"\u771f\u5b9e\u59d3\u540d",dataIndex:"realName",key:"realName"},{title:"\u57ce\u5e02",dataIndex:"cityCode",key:"cityCode",render:function(e,t){var a="321000"===t.cityCode?0:1;return t.cityCode?u.createElement(x,{type:a}):"----"}},{title:"\u7ed1\u5b9a\u624b\u673a",dataIndex:"phone",key:"phone"},{title:"IP",dataIndex:"ip",key:"ip"},{title:"\u6ce8\u518c\u65f6\u95f4",dataIndex:"registertime",key:"registertime"},{title:"\u6700\u540e\u767b\u9646\u65f6\u95f4",dataIndex:"lastlogintime",key:"lastlogintime"},{title:"\u64cd\u4f5c",dataIndex:"operation",key:"operation",render:function(t,a){return u.createElement("span",null,u.createElement("a",{href:"javascript:;",onClick:e.editGroup.bind(e,a),style:{marginRight:20}},"\u6539\u53d8\u89d2\u8272"))}}],O={selectedRowKeys:i,onChange:this.onSelectChange},D=i.length>0,j=s.map(function(e,t){return u.createElement(R,{value:e.path,key:t},e.name)}),N=d.map(function(e,t){return{label:e.authName,value:e.id}}),T=this.state.editGroupData.map(function(e,t){return u.createElement(h.a.Button,{value:e.id,key:t},e.roleName)}),M=this.state.groupData.map(function(e,t){return u.createElement(h.a.Button,{value:e.id,key:t},e.roleName)});return u.createElement("div",null,u.createElement("div",{style:{marginBottom:16,textAlign:"left"}},u.createElement(f.a,{type:"primary",onClick:this.addRole.bind(this),style:{marginRight:20}},"\u6dfb\u52a0"),u.createElement(f.a,{type:"danger",disabled:!D,onClick:function(){e.deleteRole()}},"\u5220\u9664"),u.createElement("span",{style:{marginLeft:8}},D?"\u9009\u62e9\u4e86".concat(i.length,"\u9879"):"")),u.createElement("div",null,u.createElement(g.a,{rowSelection:O,columns:w,dataSource:l,pagination:{pageSize:10},onChange:this.handleChange,locale:{filterConfirm:"\u786e\u5b9a",filterReset:"\u91cd\u7f6e",emptyText:"\u6682\u65e0\u6570\u636e"}})),u.createElement("div",null,u.createElement(b.a,{width:500,title:"\u6dfb\u52a0\u7528\u6237",placement:"right",closable:!0,onClose:function(){e.setState({visible:!1,files:[]})},visible:this.state.visible},u.createElement(y.a,{onSubmit:this.handleSubmit},u.createElement(y.a.Item,{label:"\u7528\u6237\u540d",hasFeedback:!0,style:{marginBottom:0}},this.props.form.getFieldDecorator("name",{initialValue:"",setFieldsValue:this.state.name,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7528\u6237\u540d!"}]})(u.createElement(v.a,{placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u540d",onChange:function(t){e.setState({name:t.target.value})}}))),u.createElement(y.a.Item,{label:"\u8bbe\u5bc6\u7801",hasFeedback:!0,style:{marginBottom:0}},this.props.form.getFieldDecorator("pwd",{initialValue:"",setFieldsValue:this.state.pwd,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5bc6\u7801!"}]})(u.createElement(v.a,{placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u540d",onChange:function(t){e.setState({name:t.target.value})}}))),u.createElement(y.a.Item,{label:"\u771f\u5b9e\u59d3\u540d",hasFeedback:!0,style:{marginBottom:0}},this.props.form.getFieldDecorator("realName",{initialValue:"",setFieldsValue:this.state.realName,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u771f\u5b9e\u59d3\u540d!"}]})(u.createElement(v.a,{placeholder:"\u8bf7\u8f93\u5165\u771f\u5b9e\u59d3\u540d",onChange:function(t){e.setState({realName:t.target.value})}}))),u.createElement(y.a.Item,{label:"\u624b\u673a\u53f7",hasFeedback:!0,style:{marginBottom:0}},this.props.form.getFieldDecorator("phone",{initialValue:"",setFieldsValue:this.state.phone,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7!",pattern:/^1[0-9]{10}$/}]})(u.createElement(v.a,{placeholder:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7",onChange:function(t){e.setState({phone:t.target.value})}}))),u.createElement(y.a.Item,{label:"\u90ae\u7bb1",hasFeedback:!0,style:{marginBottom:0}},this.props.form.getFieldDecorator("email",{initialValue:"",setFieldsValue:this.state.email,rules:[{required:!1,message:"\u8bf7\u8f93\u5165\u90ae\u7bb1!"}]})(u.createElement(v.a,{placeholder:"\u8bf7\u8f93\u5165\u90ae\u7bb1",onChange:function(t){e.setState({email:t.target.value})}}))),u.createElement(y.a.Item,{label:"\u89d2\u8272",style:{marginBottom:0}},this.props.form.getFieldDecorator("groupId",{initialValue:1,setFieldsValue:this.state.groupId,rules:[{required:!0,message:"\u8bf7\u9009\u62e9!"}]})(u.createElement(h.a.Group,{buttonStyle:"solid",onChange:this.addRadioChange.bind(this)},M))),u.createElement(y.a.Item,{label:"\u57ce\u5e02",style:{marginBottom:0}},this.props.form.getFieldDecorator("cityCode",{initialValue:this.state.cityCode,setFieldsValue:this.state.cityCode,rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u57ce\u5e02!"}]})(u.createElement(h.a.Group,{buttonStyle:"solid",onChange:function(t){e.setState({cityCode:t.target.value})}},u.createElement(h.a.Button,{value:"321000"},"\u626c\u5dde"),u.createElement(h.a.Button,{value:"340300"},"\u868c\u57e0")))),u.createElement(y.a.Item,{label:"\u5934\u50cf",style:{marginBottom:0}},u.createElement(V,{className:"Dragger",onChange:this.handleUpload,beforeUpload:function(t){return e.setState({files:[].concat(Object(n.a)(e.state.files),[t])}),!1}},u.createElement("p",{className:"ant-upload-drag-icon"},u.createElement(C.a,{type:"inbox"})),u.createElement("p",{className:"ant-upload-hint"},"\u70b9\u51fb\u6216\u62d6\u62fd\u56fe\u7247\u81f3\u6b64\u5904"))),u.createElement("div",{style:{position:"absolute",left:0,bottom:0,width:"100%",borderTop:"1px solid #e9e9e9",padding:"10px 16px",background:"#fff",textAlign:"right"}},u.createElement(f.a,{onClick:function(){e.setState({visible:!1})},style:{marginRight:8}},"\u53d6\u6d88"),u.createElement(f.a,{type:"primary",block:!1,htmlType:"submit",className:"login-form-button",disabled:(k=this.props.form.getFieldsError(),Object.keys(k).some(function(e){return k[e]}))},"\u786e\u8ba4"))))),u.createElement("div",null,u.createElement(b.a,{width:800,title:"\u7f16\u8f91\u7528\u6237\u6743\u9650",placement:"right",closable:!0,onClose:function(){e.setState({editVisible:!1,files:[]})},visible:this.state.editVisible},u.createElement("div",{style:{marginBottom:25}},u.createElement("span",null,"\u89d2\u8272\u540d\uff1a"),u.createElement(v.a,{style:{width:"70%"},placeholder:"\u8bf7\u8f93\u5165\u5206\u7c7b\u540d",onChange:function(t){e.setState({defaultRoleName:t.target.value})},defaultValue:this.state.defaultRoleName,value:this.state.defaultRoleName})),u.createElement(S,{tableData:o,roleGroupId:r,editData:this.editSubmitRole.bind(this)}),u.createElement("div",{style:{position:"absolute",left:0,bottom:0,width:"100%",borderTop:"1px solid #e9e9e9",padding:"10px 16px",background:"#fff",textAlign:"right"}},u.createElement(f.a,{onClick:function(){e.setState({editVisible:!1})},style:{marginRight:8}},"\u53d6\u6d88"),u.createElement(f.a,{onClick:function(){e.submitRole()},type:"primary"},"\u786e\u8ba4"))),u.createElement(b.a,{width:500,title:"\u6dfb\u52a0\u83dc\u5355\u6743\u9650",placement:"right",closable:!0,onClose:function(){e.setState({addVisible:!1})},visible:this.state.addVisible},u.createElement("div",{style:{marginBottom:25}},u.createElement("span",null,"\u83dc\u5355\u540d\uff1a"),u.createElement(m.a,{style:{width:320},onChange:this.onMenuSelectChange.bind(this)},j)),u.createElement("div",{style:{marginTop:25}},u.createElement("span",{style:{marginRight:8}},"\u5b50\u83dc\u5355: "),N.length>0?u.createElement(E.a.Group,{options:N,onChange:this.onCheckboxSelectChange.bind(this),style:{display:"block",marginTop:16}}):u.createElement("span",null,"\u8bf7\u5148\u9009\u62e9\u83dc\u5355")),u.createElement("div",{style:{position:"absolute",left:0,bottom:0,width:"100%",borderTop:"1px solid #e9e9e9",padding:"10px 16px",background:"#fff",textAlign:"right"}},u.createElement(f.a,{onClick:function(){e.setState({addVisible:!1})},style:{marginRight:8}},"\u53d6\u6d88"),u.createElement(f.a,{onClick:this.sumitAddMenu.bind(this),type:"primary"},"\u786e\u8ba4"))),u.createElement(I.a,{title:"\u9009\u62e9\u89d2\u8272",visible:this.state.editGroupModal,onOk:this.handleOk,onCancel:this.handleCancel,okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88"},u.createElement("div",null,u.createElement(h.a.Group,{defaultValue:"a",buttonStyle:"solid",onChange:this.radioChange.bind(this)},T))),u.createElement(I.a,{visible:this.state.showImage,onCancel:function(){return e.setState({showImage:!1})},footer:null,destroyOnClose:!0},(p=this.state.imageSrc,u.createElement("img",{src:p,alt:"",style:{width:"100%"}})))))}}]),t}(u.Component),T=y.a.create({name:"validate"})(N);t.default=T}}]);
//# sourceMappingURL=15.843f6023.chunk.js.map